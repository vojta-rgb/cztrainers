/* --------- Tokens (light default) --------- */
:root{
  --navbar-h:64px;
  --panel-w:340px;

  --panel-bg:#fff;
  --panel-text:#111;
  --panel-border:rgba(0,0,0,.08);
  --input-bg:#fff;
  --input-text:#111;
  --input-border:rgba(0,0,0,.14);
  --hint-text:rgba(0,0,0,.70);
  --fab-bg:#0072CE;
  --fab-text:#fff;
}

/* --------- DARK via body.dark --------- */
body.dark{
  --panel-bg:#161616;
  --panel-text:#fff;
  --panel-border:rgba(255,255,255,.08);
  --input-bg:#121212;
  --input-text:#fff;
  --input-border:#2a2a2a;
  --hint-text:rgba(255,255,255,.75);
  --fab-bg:#2b7dff;
  --fab-text:#fff;
}

/* --------- Layout --------- */
.map-layout{
  position:relative;
  display:grid;
  grid-template-columns:var(--panel-w) 1fr;
  height:calc(100vh - var(--navbar-h));
}

/* --------- Sidebar --------- */
.map-panel{
  background:var(--panel-bg);
  color:var(--panel-text);
  border-right:1px solid var(--panel-border);
  padding:16px;
  overflow:auto;
  color-scheme:light;
}
body.dark .map-panel{ color-scheme:dark; }

.map-panel__header{
  display:flex;align-items:center;justify-content:space-between;gap:8px;
  margin-bottom:8px;
}
.map-panel__header h1{ margin:0;font-size:1.25rem; }
.map-panel__close{
  border:none;background:transparent;font-size:1.5rem;line-height:1;
  cursor:pointer;opacity:.7;
}
.map-panel__close:hover{ opacity:1; }
.map-panel__section{ margin:12px 0; }
.map-panel__hint{ font-size:.85rem;color:var(--hint-text);margin-top:10px; }

/* Fields */
.map-field{ display:grid;gap:6px; }
.map-field span{ font-size:.9rem;opacity:.9; }
.map-field input,
.map-field select{
  width:100%;
  box-sizing:border-box;
  background:var(--input-bg);
  color:var(--input-text);
  border:1px solid var(--input-border);
  border-radius:10px;
  padding:10px 12px;
  font:inherit;outline:none;
}
.map-field input:focus,
.map-field select:focus{
  border-color:rgba(0,114,206,.6);
  box-shadow:0 0 0 3px rgba(0,114,206,.15);
}
.map-field input::placeholder{ color:var(--hint-text); }

/* Make the location search fit the panel */
#searchPlace{ display:block;width:100%; }

/* Google Places dropdown (when enabled) */
.pac-container{
  z-index:2000 !important;
  border-radius:10px;
  overflow:hidden;
  border:1px solid var(--panel-border);
  background:var(--panel-bg);
  color:var(--panel-text);
  box-shadow:0 10px 24px rgba(0,0,0,.18);
}
.pac-item{ color:var(--panel-text); }
.pac-item:hover{ background:rgba(0,0,0,.05); }
body.dark .pac-item:hover{ background:rgba(255,255,255,.07); }

/* --------- Map area --------- */
.map-canvas-wrap{ position:relative; }
.map-canvas{ width:100%;height:100%; }

/* Floating button (open filters) */
.map-fab{
  position:absolute;bottom:16px;left:16px;
  border:none;border-radius:999px;
  padding:10px 14px;font-weight:600;
  background:var(--fab-bg);color:var(--fab-text);
  box-shadow:0 4px 16px rgba(0,0,0,.2);
  cursor:pointer;
}
.map-fab:hover{ filter:brightness(1.05); }

/* InfoWindow */
.map-iw{ min-width:220px; }
.map-iw__row{ display:flex;gap:10px;align-items:center; }
.map-iw__avatar{ width:48px;height:48px;border-radius:50%;object-fit:cover; }
.map-iw__meta small{ display:block;opacity:.8;line-height:1.2;margin-top:2px; }
.map-iw__btn{ display:inline-block;margin-top:8px; }

/* --------- Mobile drawer --------- */
@media (max-width:980px){
  .map-layout{
    grid-template-columns:1fr;
    height:calc(100vh - 56px);
  }
  .map-panel{
    position:absolute;z-index:5;
    top:0;bottom:0;left:0;
    width:min(92vw,380px);
    transform:translateX(-100%);
    transition:transform .24s ease;
    box-shadow:0 10px 24px rgba(0,0,0,.25);
    border-right:none;border-radius:0 16px 16px 0;
  }
  .map-panel.open{ transform:translateX(0); }
  .map-canvas-wrap.panel-open .map-fab{ display:none; }

  .pac-container{ max-width:min(92vw,380px); }
}

/* Hint Maps for auto light/dark rendering with a dual-mode Map ID */
.map-canvas { color-scheme: light; }
body.dark .map-canvas { color-scheme: dark; }

/* === Avatar pin (AdvancedMarker content) === */
.trainer-pin {
  position: relative;
  width: 34px; height: 34px;
  display: grid; place-items: center;
  background: #fff;
  border: 1px solid rgba(0,0,0,.15);
  border-radius: 999px;
  box-shadow: 0 1px 6px rgba(0,0,0,.25);
  transform: translateY(-6px); /* lift pin slightly */
}
.trainer-pin img.pin-avatar {
  width: 26px; height: 26px;
  border-radius: 50%;
  object-fit: cover;
}

/* dark mode */
body.dark .trainer-pin {
  background: #0b0f14;
  border-color: rgba(255,255,255,.18);
  box-shadow: 0 1px 6px rgba(0,0,0,.8);
}

/* ===== Trainer avatar pins (AdvancedMarker) ===== */
.trainer-pin{
  all: unset;
  display:inline-flex;
  align-items:center; justify-content:center;
  width:42px; height:42px;
  border-radius:50%;
  box-shadow:0 6px 18px rgba(0,0,0,.25), 0 0 0 2px #fff;
  background:#fff;
  cursor:pointer;
}
.trainer-pin .pin-avatar{
  width:100%; height:100%;
  border-radius:50%;
  object-fit:cover;
}
body.dark .trainer-pin{ box-shadow:0 6px 18px rgba(0,0,0,.5), 0 0 0 2px #1f1f1f; background:#1f1f1f; }

/* ===== Bottom Sheet (two-state) ===== */
:root{
  --ts-bg:#fff;
  --ts-text:#111;
  --ts-muted:#6b7280;
  --ts-border:rgba(17,17,17,.08);
  --ts-accent:#0072CE;
  --ts-elev:0 10px 30px rgba(0,0,0,.18);
}
body.dark{
  --ts-bg:#161616;
  --ts-text:#f4f4f4;
  --ts-muted:#a9acb3;
  --ts-border:rgba(255,255,255,.10);
  --ts-accent:#4da3ff;
  --ts-elev:0 16px 40px rgba(0,0,0,.5);
}

.ts-scrim{
  position:fixed; inset:0; background:rgba(0,0,0,.35);
  opacity:0; pointer-events:none; transition:opacity .18s ease;
  z-index: 80;
}
.ts-sheet{
  position:fixed; left:0; right:0; bottom:0;
  display:none;
  justify-content:center; align-items:flex-end;
  z-index: 90;
}
.ts-sheet.open{ display:flex; }
.ts-sheet.open + .ts-scrim,
.ts-sheet.open ~ .ts-scrim{ opacity:1; pointer-events:auto; }

.ts-card{
  background:var(--ts-bg); color:var(--ts-text);
  width: min(640px, calc(100% - 24px));
  max-height: 70vh; overflow:auto;
  border:1px solid var(--ts-border);
  border-radius:24px; box-shadow:var(--ts-elev);
  padding:16px; margin:12px;
  outline:none;
}

.ts-row{ display:flex; gap:12px; align-items:center; }
.ts-avatar{ width:72px; height:72px; border-radius:50%; object-fit:cover; border:2px solid #fff; }
body.dark .ts-avatar{ border-color:#1f1f1f; }

.ts-main{ display:flex; flex-direction:column; gap:4px; }
.ts-name{ margin:0; font-size:1.15rem; font-weight:800; color:var(--ts-text); }
.ts-meta{ color:var(--ts-muted); font-size:.95rem; }
.ts-badge{
  display:inline-block; align-self:flex-start;
  margin-top:4px; padding:2px 8px; font-size:.78rem;
  border-radius:999px; background:rgba(0,114,206,.12); color:var(--ts-accent);
}

.ts-lines{ margin:12px 0 4px; display:flex; flex-direction:column; gap:6px; }
.ts-line{ color:var(--ts-text); font-size:.95rem; }
.ts-line:empty{ display:none; }

.ts-actions{ display:flex; gap:10px; margin-top:8px; }
.rt-btn{
  display:inline-flex; align-items:center; justify-content:center;
  min-height:40px; padding:0 14px; border-radius:12px; font-weight:700;
  border:1px solid transparent; text-decoration:none; cursor:pointer;
}
.rt-btn-primary{ background:var(--ts-accent); color:#fff; }
.rt-btn-primary:hover{ filter:brightness(1.06); }
.rt-btn-ghost{ background:transparent; color:var(--ts-text); border-color:var(--ts-border); }
.rt-btn-ghost:hover{ background:rgba(0,0,0,.04); }
body.dark .rt-btn-ghost:hover{ background:rgba(255,255,255,.06); }